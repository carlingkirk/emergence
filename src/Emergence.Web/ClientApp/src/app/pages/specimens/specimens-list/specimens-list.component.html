<form (ngSubmit)="search()">
    <div *ngIf="searchRequest">
        <ng-container *ngIf="showSearch">
            <input type="text" [(ngModel)]="searchRequest.searchText" name="search" />
            <button class="btn btn-primary" type="submit">Search</button>
            <button type="button" class="btn btn-primary" (click)="toggleFilters()">{{showFilters ? 'Hide Filters' : 'Show Filters'}}</button>
            <button type="button" class="btn btn-primary" (click)="resetSearch()">Reset</button>
            <ng-container *ngIf="!forUserId">
                <input type="checkbox" class="check-lg" [(ngModel)]="showPublic" name="show-public" />
                <label for="show-public"> Show Public</label>
            </ng-container>
        </ng-container>
        <input type="checkbox" class="check-lg" [(ngModel)]="listView" name="list-view" />
            <label for="list-view"> List View</label>
        <a [routerLink]='["/specimens/edit/0"]'>
            <button type="button" class="btn btn-primary"><span class="oi oi-plus btn-oi"></span>Specimen</button>
        </a>
        <app-search-filters *ngIf="showFilters && searchResult" (filtersChanged)="filtersChange($event)" [filterBody]="searchResult.filters"></app-search-filters>
        <ng-container *ngIf="listView">
            <table class="list">
                <thead app-sortable-headers [columns]="columns" [sortBy]="searchRequest.sortBy" [sortDirection]="searchRequest.sortDirection" (sortChanged)="sortChange($event)">
                <tbody>
                    <tr *ngIf="totalCount == 0">
                        <td><span>No specimens found</span></td>
                    </tr>
                    <tr *ngFor="let specimen of specimens">
                        <td>
                            <a [routerLink]='["/specimens", specimen.specimenId]'>
                                <span class="link">{{ specimen.lifeform?.scientificName }}</span>
                            </a>
                        </td>
                        <td>
                            <span>{{ specimen.name }}</span>
                        </td>
                        <td>
                            <span>{{ specimen.inventoryItem?.quantity }}</span>
                        </td>
                        <td>
                            <span>{{ specimen.specimenStage }}</span>
                        </td>
                        <td>
                            <span>{{ specimen.inventoryItem?.status }}</span>
                        </td>
                        <td>
                            <span>
                                {{ specimen.inventoryItem?.dateAcquired | date }}
                            </span>
                        </td>
                        <td>
                            <span *ngIf="specimen.inventoryItem?.origin" class="link">{{ specimen.inventoryItem?.origin?.name }}</span>
                            <span *ngIf="!specimen.inventoryItem?.origin"></span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </ng-container>
        <ng-container *ngIf="!listView">
            <div class="container">
                <div class="row">
                    <span *ngIf="totalCount == 0">No specimens found</span>
                    <ng-container *ngFor="let specimen of specimens">
                        <app-content-card class="col-lg-4 col-md-6 col-xs item-card"
                            [name]="specimen.lifeform?.scientificName" 
                            [colorSearch]="specimen.lifeform?.commonName" 
                            [photos]="specimen.photos" >
                            <a [routerLink]='["/specimens", specimen.specimenId]'>
                                <div class="col-12">
                                    <span class="link">{{ specimen.lifeform?.commonName }}</span>
                                </div>
                                <div class="col-12">
                                    <span class="link">{{ specimen.lifeform?.scientificName }}</span>
                                </div>
                                <div *ngIf="!specimen.lifeform?.scientificName && !specimen.lifeform?.commonName" class="col-12">
                                    <span *ngIf="specimen.inventoryItem.name" class="link">{{ specimen.inventoryItem.name }}</span>
                                    <span *ngIf="!specimen.inventoryItem.name" class="link">{{ specimen.name }}</span>
                                </div>
                            </a>
                            <div class="col-12">
                                <span>{{ specimen.inventoryItem.quantity }} </span>
                                <span>{{ specimen.specimenStage }}</span>
                            </div>
                            <div class="col-12">
                                <span>by {{specimen.inventoryItem.user.displayName }}</span>
                            </div>
                        </app-content-card>
                    </ng-container>
                </div>
            </div>
        </ng-container>
    </div>
    <div>
        <app-pager *ngIf="searchResult" [count]="totalCount" [take]="searchRequest.take" (pageChange)="pageChanged($event)"></app-pager>
        <a [routerLink]='["/specimens/edit/0"]'>
            <button type="button" class="btn btn-primary"><span class="oi oi-plus btn-oi"></span>Specimen</button>
        </a>
    </div>
</form>